Factored out from Camigo. Currently on hold.
